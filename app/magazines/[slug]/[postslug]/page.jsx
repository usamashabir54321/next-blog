'use client';
import PostSidebar from "@/components/post/PostSidebar";
import { useParams } from "next/navigation";
import { useEffect, useState } from "react";

const PostSingle = () => {
    const params = useParams();
    const { postslug } = params;
    const decodePostSlug = decodeURIComponent(postslug);
    const [postData, setPostData] = useState('nothing');
    const [subscription, setSubscription] = useState('');
    useEffect(() => {
        // current user name
        const user_name = localStorage.getItem('user_name');
        // if user name exists
        if (user_name) {
            // check weather user has subscription or not
            // getting post data if user has buy subscription plan
            setPostData('loading');
            getPostData();
        } else {
            setSubscription('no');
            setTimeout(() => { window.open(`${process.env.NEXT_PUBLIC_BACKEND_URL}/membership-account/membership-levels`); }, 2000);
        }
    }, []);
    const getPostData = async () => {
        const resp = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}/wp-json/wp/v2/posts?slug=${decodePostSlug}`);
        const data = await resp.json();
        // setting post data to react state
        setPostData(data[0]);
    };
    return (
        <div className="sidebar_right">
            {/* page content */}
            <div className="page_content_wrap">
                <div className="content_wrap">
                    <div className="content">
                        {  subscription == 'no' && <p>Please buy subscription</p> }
                        { postData == 'loading' && 'لوڈ ہو رہا ہے۔...' }
                        {
                            postData.id &&
                            <>
                                {/* post details content */}
                                <article className="itemscope post_item post_item_single post_featured_default post_format_standard post-492 post type-post status-publish format-standard has-post-thumbnail hentry category-masonry tag-activities tag-elementary tag-pre-school tag-sport" itemScope="" itemType="//schema.org/Article">
                                    <h1 itemProp="name" className="post_title entry-title">{postData.title.rendered}</h1>
                                    <section className="post_featured">
                                        <div className="post_thumb" data-image="https://kidsplanet.ancorathemes.com/wp-content/uploads/2015/08/Depositphotos_30164331_original.jpg" data-title="Do You Think You Can Spoil Your Baby with Too Much Love?">
                                            <a className="hover_icon hover_icon_view inited" href="https://kidsplanet.ancorathemes.com/wp-content/uploads/2015/08/Depositphotos_30164331_original.jpg" title="Do You Think You Can Spoil Your Baby with Too Much Love?" rel="prettyPhoto[slideshow]"><img className="wp-post-image" width="1170" height="660" alt="Do You Think You Can Spoil Your Baby with Too Much Love?" src="https://kidsplanet.ancorathemes.com/wp-content/uploads/2015/08/Depositphotos_30164331_original-1170x660.jpg" itemProp="image" /></a>
                                        </div>
                                    </section>
                                    <div className="post_info">
                                        <span className="post_info_item post_info_posted"><a href="https://kidsplanet.ancorathemes.com/do-you-think-you-can-spoil-your-baby-with-too-much-love/" className="post_info_date date updated" itemProp="datePublished" content="2015-08-10">August 10, 2015</a></span>
                                        <span className="post_info_item post_info_posted_by vcard" itemProp="author">by <a href="https://kidsplanet.ancorathemes.com/author/admin/" className="post_info_author">admin</a></span>
                                        <span className="post_info_item post_info_counters"> <a className="post_counters_item post_counters_comments icon-comment" title="Comments - 0" href="https://kidsplanet.ancorathemes.com/do-you-think-you-can-spoil-your-baby-with-too-much-love/#respond"><span className="post_counters_number">0</span></a>
                                        <a className="post_counters_item post_counters_likes icon-heart-empty enabled inited" title="Like" href="#" data-postid="492" data-likes="3" data-title-like="Like" data-title-dislike="Dislike"><span className="post_counters_number">3</span></a>
                                        </span>
                                    </div>
                                    <section className="post_content" itemProp="articleBody">
                                        <p>Sed ut perspiciatis, unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam eaque ipsa, quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt, explicabo. Nemo enim ipsam voluptatem, quia voluptas sit, aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos, qui ratione voluptatem sequi nesciunt, neque porro quisquam est, qui dolorem ipsum, quia dolor sit, amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt, ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?</p>
                                        <p>Quis autem vel eum iure reprehenderit, qui in ea voluptate velit esse, quam nihil molestiae consequatur, vel illum, qui dolorem eum fugiat, quo voluptas nulla pariatur? At vero eos et accusamus et iusto odio dignissimos ducimus, qui blanditiis praesentium voluptatum deleniti atque corrupti, quos dolores et quas molestias excepturi sint, obcaecati cupiditate non provident, similique sunt in culpa, qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio, cumque nihil impedit, quo minus id, quod maxime placeat, facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.</p>
                                        <p>Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet, ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.</p>
                                        <div className="post_info post_info_bottom">
                                            <span className="post_info_item post_info_tags">Tags: <a className="post_tag_link" href="https://kidsplanet.ancorathemes.com/tag/activities/">activities</a>, <a className="post_tag_link" href="https://kidsplanet.ancorathemes.com/tag/elementary/">elementary</a>, <a className="post_tag_link" href="https://kidsplanet.ancorathemes.com/tag/pre-school/">pre-school</a>, <a className="post_tag_link" href="https://kidsplanet.ancorathemes.com/tag/sport/">sport</a></span>
                                        </div>
                                    </section>
                                    <div className="post_info post_info_bottom post_info_share post_info_share_horizontal">
                                        <div className="sc_socials sc_socials_size_small sc_socials_share sc_socials_dir_horizontal">
                                            <span className="share_caption">Share:</span>
                                            <div className="sc_socials_item social_item_popup"><a href="https://www.facebook.com/sharer.php?u=link" className="social_icons social_facebook inited"  data-count="facebook" data-link="https://www.facebook.com/sharer.php?u=link" target="_blank"><span className="icon-facebook"></span></a><span className="share_counter">0</span></div>
                                            <div className="sc_socials_item social_item_popup"><a href="https://www.tumblr.com/share?v=3&amp;u=link&amp;t=title&amp;s=descr" className="social_icons social_tumblr inited"  data-count="tumblr" data-link="https://www.tumblr.com/share?v=3&amp;u=link&amp;t=title&amp;s=descr" target="_blank"><span className="icon-tumblr"></span></a></div>
                                        </div>
                                    </div>
                                    About Author 
                                    <section className="post_author author vcard" itemProp="author" itemScope="" itemType="//schema.org/Person">
                                        <div className="post_author_avatar">
                                            <a href="https://kidsplanet.ancorathemes.com/author/admin/" itemProp="image">
                                                <img alt="" src="https://secure.gravatar.com/avatar/b8577b8a0f5559455302b856a7f10acd?s=75&amp;d=mm&amp;r=g" srcSet="https://secure.gravatar.com/avatar/b8577b8a0f5559455302b856a7f10acd?s=150&amp;d=mm&amp;r=g 2x" className="avatar avatar-75 photo" height="75" width="75" loading="lazy" decoding="async" />
                                            </a>
                                        </div>
                                        <div className="about_author">
                                            <span className="post_author_title"></span>
                                            <div className="post_author_name"><span itemProp="name"><a href="https://kidsplanet.ancorathemes.com/author/admin/" className="fn">admin</a></span></div>
                                            <div className="post_author_info" itemProp="description">Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</div>
                                        </div>
                                    </section>
                                    <section className="related_wrap related_wrap_empty"></section>
                                </article>
                                {/* post comments */}
                                <section className="comments_wrap">
                                    <div className="comments_form_wrap">
                                        <h3 className="section_title comments_form_title">Add Comment</h3>
                                        <div className="comments_form">
                                            <div id="respond" className="comment-respond">
                                                <h3 id="reply-title" className="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/do-you-think-you-can-spoil-your-baby-with-too-much-love/#respond" style={{ display: 'none' }}>Cancel reply</a></small></h3>
                                                <form action="https://kidsplanet.ancorathemes.com/wp-comments-post.php" method="post" id="commentform" className="comment-form">
                                                    <div className="wp-social-login-widget">
                                                        <div className="wp-social-login-connect-with">Connect with:</div>
                                                        <div className="wp-social-login-provider-list">
                                                            <a rel="nofollow" href="https://kidsplanet.ancorathemes.com/wp-login.php?action=wordpress_social_authenticate&amp;mode=login&amp;provider=Facebook&amp;redirect_to=https%3A%2F%2Fkidsplanet.ancorathemes.com%2Fdo-you-think-you-can-spoil-your-baby-with-too-much-love%2F" title="Connect with Facebook" className="wp-social-login-provider wp-social-login-provider-facebook" data-provider="Facebook" role="button">
                                                            <img alt="Facebook" src="https://kidsplanet.ancorathemes.com/wp-content/plugins/wordpress-social-login/assets/img/32x32/wpzoom//facebook.png" aria-hidden="true" />
                                                            </a>
                                                            <a rel="nofollow" href="https://kidsplanet.ancorathemes.com/wp-login.php?action=wordpress_social_authenticate&amp;mode=login&amp;provider=Twitter&amp;redirect_to=https%3A%2F%2Fkidsplanet.ancorathemes.com%2Fdo-you-think-you-can-spoil-your-baby-with-too-much-love%2F" title="Connect with Twitter" className="wp-social-login-provider wp-social-login-provider-twitter" data-provider="Twitter" role="button">
                                                            <img alt="Twitter" src="https://kidsplanet.ancorathemes.com/wp-content/plugins/wordpress-social-login/assets/img/32x32/wpzoom//twitter.png" aria-hidden="true" />
                                                            </a>
                                                        </div>
                                                        <div className="wp-social-login-widget-clearing"></div>
                                                    </div>
                                                    <p className="comments_notes">Your email address will not be published. Required fields are marked *</p>
                                                    <div className="comments_field comments_message"><label htmlFor="comment" className="required">Your Message</label><textarea id="comment" name="comment" placeholder="Comment" aria-required="true"></textarea></div>
                                                    <div>
                                                        <div className="comments_field comments_author column-1_2"><label htmlFor="author" className="required">Name</label>
                                                        <input id="author" name="author" type="text" placeholder="Name *" defaultValue="" size="30" aria-required="true" />
                                                    </div>
                                                    <div className="comments_field comments_email column-1_2">
                                                        <label htmlFor="email" className="required">Email</label>
                                                        <input id="email" name="email" type="text" placeholder="Email *" defaultValue="" size="30" aria-required="true" />
                                                    </div>
                                                        <p className="wpgdprc-checkbox
                                                            comment-form-wpgdprc">
                                                            <input type="checkbox" name="wpgdprc" id="wpgdprc" defaultValue="1" className="inited" />
                                                            <label htmlFor="wpgdprc">
                                                            By using this form you agree with the storage and handling of your data by this website.
                                                            <abbr className="wpgdprc-required" title="You need to accept this checkbox.">*</abbr>
                                                            </label>
                                                        </p>
                                                        <p className="form-submit">
                                                            <input name="submit" type="submit" id="send_comment" className="submit" defaultValue="Post Comment" disabled="disabled" />
                                                            <input type="hidden" name="comment_post_ID" defaultValue="492" id="comment_post_ID" />
                                                            <input type="hidden" name="comment_parent" id="comment_parent" defaultValue="0" />
                                                        </p>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </>
                        }
                        {
                            !postData.id && !postData == 'loading' && <p>مضمون کا ڈیٹا نہیں ہے۔</p>
                        }
                    </div>
                    {/* post side bar */}
                    <PostSidebar />
                </div>
            </div>
        </div>
    )
};

export default PostSingle;